import java.sql.Connection;
import java.sql.Statement;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;

public class DOMagQuery
{
	private static final String DATABASE_URL = 
			"jdbc:mysql://mysql.osteopathic.org:3306/domag";
	private static final String USER = "domag_user";
	private static final String SITE_URL = "www.do-online.org";
	private static final String PASSWORD = "1q2w3e4r5t";

	private Connection connection; // managed connection
	private Statement statement; // query statement
	private ResultSet resultSet; // manages result

	/**
	 *	
	 */
	public DOMagQuery()
	{

	}

	/**
	 *	This method executes a query to the database.
	 *	Example query: 
	 *	myQuery.connect("fullcollegenames", "29325", 
	 *	SELECT fullname from fullcollegenames where code='29325'
	 *	SELECT [column] from [table] where [field] = [value]
	 *
	 *	**TEMPORARILY PUBLIC**
	 *
	 *	@param		column		The column to search
	 *	@param		field		The table to use
	 *	@param		field		The column to get the value from
	 *	@param		field		The value to match
	 *	
	 *	@return					The query results
	 */
	public String connect(String column, String table, String field, 
		String value)
	{
		String s = "";

		try {
			// establish connection to database
			connection = DriverManager.getConnection(
				DATABASE_URL, USER, PASSWORD);

			// create Statement for querying database
			statement = connection.createStatement();
			
			// query database
			resultSet = statement.executeQuery(
				"SELECT " + column + " from " + table + 
				"WHERE " + field + "='" + value + "'");

			// process query results
			ResultSetMetaData metaData = resultSet.getMetaData();

			while (resultSet.next()) {
				s = resultSet.getString(column);
			}

		} catch (SQLException sqle) {
			System.out.println("Error interacting with database");
			sqle.printStackTrace();
		} finally {
			try {
				resultSet.close();
				statement.close();
				connection.close();
			} catch (SQLException sqle) {
				System.out.println("Error closing the database connection");
				sqle.printStackTrace();
			}
		}

		return s;
	}

}
